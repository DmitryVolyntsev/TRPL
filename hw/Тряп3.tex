\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{tikz}
\usepackage{txfonts}
\usepackage[russian]{babel}

\title{Тряп-3}
\author{Волынцев Дмитрий 676 гр.}
\date{25 сентября 2017}

\begin{document}

\maketitle

\section
\\
По определению префикс-функция возвращает максимальный по длине собственный префикс, являющийся так же суффиксом слова. Пусть $a_1 = l(\omega)$ - такой префикс. Второй по длине префикс исходного слова $a_2$, являющийся суффиксом, будет частью $a_1$, т.к. $a_1$ содержит начало и конец исходного слова и является максимальным. Так как каждый последующий "префикс-суффикс" обладает теми же свойствами, получим последовательность вложенных друг в друга подслов, имеющих общее начало(новый префикс) и конец(новый суффикс), которые совпадают сами. Новые же префикс-суффиксфы являются новыми префикс-функциями от предыдущих префикс-функций, т.е.:\\
$a_1 = l(\omega)$\\
$a_2 = l(a_1) = l(l(\omega))$\\
$a_3 = l(a_2) = l(l(a_1)) = l(l(l(\omega)))$\\
и т.д.\\
Утверждение доказано.\\
\section
\\
В соответствии с определением КМП-автомата построим автомат, корректность которого следует из построения и определения.\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (16.8,-15.7) circle (3);
\draw (16.8,-15.7) node {$\varepsilonup$};
\draw [black] (30.4,-15.6) circle (3);
\draw (30.4,-15.6) node {$a$};
\draw [black] (16.8,-28.7) circle (3);
\draw (16.8,-28.7) node {$ab$};
\draw [black] (30.4,-28.7) circle (3);
\draw (30.4,-28.7) node {$aba$};
\draw [black] (46.6,-28.7) circle (3);
\draw (46.6,-28.7) node {$abab$};
\draw [black] (46.6,-15.6) circle (3);
\draw (46.6,-15.6) node {$ababb$};
\draw [black] (46.6,-15.6) circle (2.4);
\draw [black] (15.477,-13.02) arc (234:-54:2.25);
\draw (16.8,-8.45) node [above] {$b$};
\fill [black] (18.12,-13.02) -- (19,-12.67) -- (18.19,-12.08);
\draw [black] (29.077,-12.92) arc (234:-54:2.25);
\draw (30.4,-8.35) node [above] {$a$};
\fill [black] (31.72,-12.92) -- (32.6,-12.57) -- (31.79,-11.98);
\draw [black] (43.92,-16.923) arc (-36:-324:2.25);
\draw (39.35,-15.6) node [left] {$a,b$};
\fill [black] (43.92,-14.28) -- (43.57,-13.4) -- (42.98,-14.21);
\draw [black] (19.8,-15.68) -- (27.4,-15.62);
\fill [black] (27.4,-15.62) -- (26.6,-15.13) -- (26.6,-16.13);
\draw (23.6,-15.14) node [above] {$a$};
\draw [black] (28.24,-17.68) -- (18.96,-26.62);
\fill [black] (18.96,-26.62) -- (19.88,-26.42) -- (19.19,-25.7);
\draw (22.58,-21.67) node [above] {$b$};
\draw [black] (16.8,-25.7) -- (16.8,-18.7);
\fill [black] (16.8,-18.7) -- (16.3,-19.5) -- (17.3,-19.5);
\draw (16.3,-22.2) node [left] {$b$};
\draw [black] (19.8,-28.7) -- (27.4,-28.7);
\fill [black] (27.4,-28.7) -- (26.6,-28.2) -- (26.6,-29.2);
\draw (23.6,-29.2) node [below] {$a$};
\draw [black] (30.4,-25.7) -- (30.4,-18.6);
\fill [black] (30.4,-18.6) -- (29.9,-19.4) -- (30.9,-19.4);
\draw (30.9,-22.15) node [right] {$a$};
\draw [black] (32.618,-26.695) arc (123.94681:56.05319:10.533);
\fill [black] (44.38,-26.7) -- (44,-25.83) -- (43.44,-26.66);
\draw (38.5,-24.4) node [above] {$b$};
\draw [black] (44.08,-30.316) arc (-64.06786:-115.93214:12.761);
\fill [black] (32.92,-30.32) -- (33.42,-31.12) -- (33.86,-30.22);
\draw (38.5,-32.1) node [below] {$a$};
\draw [black] (46.6,-25.7) -- (46.6,-18.6);
\fill [black] (46.6,-18.6) -- (46.1,-19.4) -- (47.1,-19.4);
\draw (47.1,-22.15) node [right] {$b$};
\end{tikzpicture}
\end{center}
\\
Протокол работы алгоритма КМП:\\
$ababb\#a$ - префикс подслова = суффикс слова $= a$; префикс-функция $= 1$\\
$ababb\#aa$ - префикс подслова = суффикс слова $= a$; префикс-функция $= 1$\\
$ababb\#aab$ - префикс подслова = суффикс слова $= ab$; префикс-функция $= 2$\\
$ababb\#aaba$ - префикс подслова = суффикс слова $= aba$; префикс-функция $= 3$\\
$ababb\#aabab$ - префикс подслова = суффикс слова $= abab$; префикс-функция $= 4$\\
$ababb\#aababa$ - префикс подслова = суффикс слова $= aba$; префикс-функция $= 3$\\
$ababb\#aababab$ - префикс подслова = суффикс слова $= abab$; префикс-функция $= 4$\\
$ababb\#aabababb$ - префикс подслова = суффикс слова $= ababb$; префикс-функция $= 5$\\
Есть вхождение слова\\
$ababb\#aabababbb$ - префикс подслова = суффикс слова $= \varepsilonup$; префикс-функция $= 0$\\
\section
\\
Реализуем алгоритм добавления нового слова:\\
Возможны 2 варианта:\\
1) Для нового слова уже есть состояние в автомате, то есть это слово является подсловом какого-то принимаемого слова. В этом случае просто делаем данное состояние принимающим, значит слово теперь принимается автоматом.\\
2) Для нового слова нет состояния в автомате. В данном случае ищем среди существующих состояний то, которое является максимальным префиксом $\omega[0,i]$ добавляемого слова (идем из состояния $\varepsilonup$ по символам, пока не дойдем до состояния, из которого нельзя пройти дальше с нашим словом). Далее добавляем посимвольный переходы (сначала символ $\omega[i+1]$ и т.д.) и необходимые состояния $\omega[0,i+1]$ до того момента, пока все слово не станет состоянием. Делаем это состояние принимающим. Таким образом новое слово принимается автоматом, который остается детерминированным по построению (переходы определены однозначно).\\
\\
Реализуем алгоритм удаления слова:\\
Также возможны 2 варианта:\\
1) Принимающее состояние слова имеет переходы к другим принимающим состояниям. В этом случае просто делаем это состояние непринимающим. Таким образом мы удалили слово из словаря, не нарушив вхождений других слов.\\
2) Принимающее состояние слова не имеет переходов. В этом случае удалаяем данное состояние, переходы к нему и те НЕПРИНИМАЮЩИЕ состояния, из которых эти переходы были осуществлены. Т.е. удаляем цепочку состояний и переходов до ближайшего принимающего состояния (по стрелкам, но в обратную сторону). Таким образом мы удалили слово, не нарушив вхождений других слов.\\
\section 
\\
В первую очередь строим состояние для пустого слова $\varepsilonup$ и в зависимости от того, входит оно во множество $S$ или нет, делаем его принимающим/непринимающим.\\
\\
Далее используем алгоритм добавления слова, не имеющего состояния, в словарь из задачи 3. Все последующие слова из множества $S$ проверяем посредством того же алгоритма и строим соответствующий автомат, который будет являться детерминированным и корректным по построению (задача 3).\\
\section
\\

\section
\\
Искомый словарь:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (18,-27.7) circle (3);
\draw (18,-27.7) node {$\varepsilonup$};
\draw [black] (30.4,-36.8) circle (3);
\draw (30.4,-36.8) node {$c$};
\draw [black] (30.4,-36.8) circle (2.4);
\draw [black] (30.4,-27.7) circle (3);
\draw (30.4,-27.7) node {$b$};
\draw [black] (30.4,-27.7) circle (2.4);
\draw [black] (41.8,-27.7) circle (3);
\draw (41.8,-27.7) node {$ba$};
\draw [black] (41.8,-27.7) circle (2.4);
\draw [black] (30.4,-17.7) circle (3);
\draw (30.4,-17.7) node {$a$};
\draw [black] (41.8,-17.7) circle (3);
\draw (41.8,-17.7) node {$ac$};
\draw [black] (41.8,-17.7) circle (2.4);
\draw [black] (52.9,-17.7) circle (3);
\draw (52.9,-17.7) node {$acb$};
\draw [black] (52.9,-17.7) circle (2.4);
\draw [black] (41.8,-36.8) circle (3);
\draw (41.8,-36.8) node {$cb$};
\draw [black] (52.9,-36.8) circle (3);
\draw (52.9,-36.8) node {$cbb$};
\draw [black] (52.9,-36.8) circle (2.4);
\draw [black] (9.2,-27.7) -- (15,-27.7);
\fill [black] (15,-27.7) -- (14.2,-27.2) -- (14.2,-28.2);
\draw [black] (20.34,-25.82) -- (28.06,-19.58);
\fill [black] (28.06,-19.58) -- (27.13,-19.7) -- (27.76,-20.47);
\draw (23.25,-22.21) node [above] {$a$};
\draw [black] (33.4,-17.7) -- (38.8,-17.7);
\fill [black] (38.8,-17.7) -- (38,-17.2) -- (38,-18.2);
\draw (36.1,-17.2) node [above] {$c$};
\draw [black] (44.8,-17.7) -- (49.9,-17.7);
\fill [black] (49.9,-17.7) -- (49.1,-17.2) -- (49.1,-18.2);
\draw (47.35,-17.2) node [above] {$b$};
\draw [black] (21,-27.7) -- (27.4,-27.7);
\fill [black] (27.4,-27.7) -- (26.6,-27.2) -- (26.6,-28.2);
\draw (24.2,-27.2) node [above] {$b$};
\draw [black] (33.4,-27.7) -- (38.8,-27.7);
\fill [black] (38.8,-27.7) -- (38,-27.2) -- (38,-28.2);
\draw (36.1,-27.2) node [above] {$a$};
\draw [black] (20.42,-29.47) -- (27.98,-35.03);
\fill [black] (27.98,-35.03) -- (27.63,-34.15) -- (27.04,-34.95);
\draw (23.25,-32.75) node [below] {$c$};
\draw [black] (33.4,-36.8) -- (38.8,-36.8);
\fill [black] (38.8,-36.8) -- (38,-36.3) -- (38,-37.3);
\draw (36.1,-37.3) node [below] {$b$};
\draw [black] (44.8,-36.8) -- (49.9,-36.8);
\fill [black] (49.9,-36.8) -- (49.1,-36.3) -- (49.1,-37.3);
\draw (47.35,-37.3) node [below] {$b$};
\end{tikzpicture}
\end{center}
\\
Чтобы добавить слово $ab$ в словарь, добавим новое принимающее состояние:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (18,-27.7) circle (3);
\draw (18,-27.7) node {$\varepsilonup$};
\draw [black] (30.4,-36.8) circle (3);
\draw (30.4,-36.8) node {$c$};
\draw [black] (30.4,-36.8) circle (2.4);
\draw [black] (30.4,-27.7) circle (3);
\draw (30.4,-27.7) node {$b$};
\draw [black] (30.4,-27.7) circle (2.4);
\draw [black] (41.8,-27.7) circle (3);
\draw (41.8,-27.7) node {$ba$};
\draw [black] (41.8,-27.7) circle (2.4);
\draw [black] (30.4,-17.7) circle (3);
\draw (30.4,-17.7) node {$a$};
\draw [black] (41.8,-17.7) circle (3);
\draw (41.8,-17.7) node {$ac$};
\draw [black] (41.8,-17.7) circle (2.4);
\draw [black] (52.9,-17.7) circle (3);
\draw (52.9,-17.7) node {$acb$};
\draw [black] (52.9,-17.7) circle (2.4);
\draw [black] (41.8,-36.8) circle (3);
\draw (41.8,-36.8) node {$cb$};
\draw [black] (52.9,-36.8) circle (3);
\draw (52.9,-36.8) node {$cbb$};
\draw [black] (52.9,-36.8) circle (2.4);
\draw [black] (41.8,-7.7) circle (3);
\draw (41.8,-7.7) node {$ab$};
\draw [black] (41.8,-7.7) circle (2.4);
\draw [black] (9.2,-27.7) -- (15,-27.7);
\fill [black] (15,-27.7) -- (14.2,-27.2) -- (14.2,-28.2);
\draw [black] (20.34,-25.82) -- (28.06,-19.58);
\fill [black] (28.06,-19.58) -- (27.13,-19.7) -- (27.76,-20.47);
\draw (23.25,-22.21) node [above] {$a$};
\draw [black] (33.4,-17.7) -- (38.8,-17.7);
\fill [black] (38.8,-17.7) -- (38,-17.2) -- (38,-18.2);
\draw (36.1,-17.2) node [above] {$c$};
\draw [black] (44.8,-17.7) -- (49.9,-17.7);
\fill [black] (49.9,-17.7) -- (49.1,-17.2) -- (49.1,-18.2);
\draw (47.35,-17.2) node [above] {$b$};
\draw [black] (21,-27.7) -- (27.4,-27.7);
\fill [black] (27.4,-27.7) -- (26.6,-27.2) -- (26.6,-28.2);
\draw (24.2,-27.2) node [above] {$b$};
\draw [black] (33.4,-27.7) -- (38.8,-27.7);
\fill [black] (38.8,-27.7) -- (38,-27.2) -- (38,-28.2);
\draw (36.1,-27.2) node [above] {$a$};
\draw [black] (20.42,-29.47) -- (27.98,-35.03);
\fill [black] (27.98,-35.03) -- (27.63,-34.15) -- (27.04,-34.95);
\draw (23.25,-32.75) node [below] {$c$};
\draw [black] (33.4,-36.8) -- (38.8,-36.8);
\fill [black] (38.8,-36.8) -- (38,-36.3) -- (38,-37.3);
\draw (36.1,-37.3) node [below] {$b$};
\draw [black] (44.8,-36.8) -- (49.9,-36.8);
\fill [black] (49.9,-36.8) -- (49.1,-36.3) -- (49.1,-37.3);
\draw (47.35,-37.3) node [below] {$b$};
\draw [black] (32.66,-15.72) -- (39.54,-9.68);
\fill [black] (39.54,-9.68) -- (38.61,-9.83) -- (39.27,-10.58);
\draw (35.09,-12.21) node [above] {$b$};
\end{tikzpicture}
\end{center}
Чтобы удалить слово $ac$ из словаря, сделаем соответствующее состояние непринимающим:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (18,-27.7) circle (3);
\draw (18,-27.7) node {$\varepsilonup$};
\draw [black] (30.4,-36.8) circle (3);
\draw (30.4,-36.8) node {$c$};
\draw [black] (30.4,-36.8) circle (2.4);
\draw [black] (30.4,-27.7) circle (3);
\draw (30.4,-27.7) node {$b$};
\draw [black] (30.4,-27.7) circle (2.4);
\draw [black] (41.8,-27.7) circle (3);
\draw (41.8,-27.7) node {$ba$};
\draw [black] (41.8,-27.7) circle (2.4);
\draw [black] (30.4,-17.7) circle (3);
\draw (30.4,-17.7) node {$a$};
\draw [black] (41.8,-17.7) circle (3);
\draw (41.8,-17.7) node {$ac$};
\draw [black] (52.9,-17.7) circle (3);
\draw (52.9,-17.7) node {$acb$};
\draw [black] (52.9,-17.7) circle (2.4);
\draw [black] (41.8,-36.8) circle (3);
\draw (41.8,-36.8) node {$cb$};
\draw [black] (52.9,-36.8) circle (3);
\draw (52.9,-36.8) node {$cbb$};
\draw [black] (52.9,-36.8) circle (2.4);
\draw [black] (41.8,-7.7) circle (3);
\draw (41.8,-7.7) node {$ab$};
\draw [black] (41.8,-7.7) circle (2.4);
\draw [black] (9.2,-27.7) -- (15,-27.7);
\fill [black] (15,-27.7) -- (14.2,-27.2) -- (14.2,-28.2);
\draw [black] (20.34,-25.82) -- (28.06,-19.58);
\fill [black] (28.06,-19.58) -- (27.13,-19.7) -- (27.76,-20.47);
\draw (23.25,-22.21) node [above] {$a$};
\draw [black] (33.4,-17.7) -- (38.8,-17.7);
\fill [black] (38.8,-17.7) -- (38,-17.2) -- (38,-18.2);
\draw (36.1,-17.2) node [above] {$c$};
\draw [black] (44.8,-17.7) -- (49.9,-17.7);
\fill [black] (49.9,-17.7) -- (49.1,-17.2) -- (49.1,-18.2);
\draw (47.35,-17.2) node [above] {$b$};
\draw [black] (21,-27.7) -- (27.4,-27.7);
\fill [black] (27.4,-27.7) -- (26.6,-27.2) -- (26.6,-28.2);
\draw (24.2,-27.2) node [above] {$b$};
\draw [black] (33.4,-27.7) -- (38.8,-27.7);
\fill [black] (38.8,-27.7) -- (38,-27.2) -- (38,-28.2);
\draw (36.1,-27.2) node [above] {$a$};
\draw [black] (20.42,-29.47) -- (27.98,-35.03);
\fill [black] (27.98,-35.03) -- (27.63,-34.15) -- (27.04,-34.95);
\draw (23.25,-32.75) node [below] {$c$};
\draw [black] (33.4,-36.8) -- (38.8,-36.8);
\fill [black] (38.8,-36.8) -- (38,-36.3) -- (38,-37.3);
\draw (36.1,-37.3) node [below] {$b$};
\draw [black] (44.8,-36.8) -- (49.9,-36.8);
\fill [black] (49.9,-36.8) -- (49.1,-36.3) -- (49.1,-37.3);
\draw (47.35,-37.3) node [below] {$b$};
\draw [black] (32.66,-15.72) -- (39.54,-9.68);
\fill [black] (39.54,-9.68) -- (38.61,-9.83) -- (39.27,-10.58);
\draw (35.09,-12.21) node [above] {$b$};
\end{tikzpicture}
\end{center}
\\
\section
\\
Будем искать подслово $abbaa$ в слове $ababbabbaab$. Пользуясь алгоритмом из Шеня, запишем слова в виде $abbaa\#ababbabbaab$ и вычислим префикс-функцию, причем если какая-нибудь префикс-функция будет равна 5 (т.к. подслово длины 5), это будет означать вхождение подслова в слово. Получим следующую запись (здесь индексы - соответствующая символу префикс-функция): $a_1b_2a_1b_2b_3a_4b_2b_3a_4a_5b_2$. Как видно, подслово входит в слово.\\
\\
Протокол работы алгоритма КМП:\\
$abbaa\#a$ - префикс подслова = суффикс слова $= a$; префикс-функция $= 1$\\
$abbaa\#ab$ - префикс подслова = суффикс слова $= ab$; префикс-функция $= 2$\\
$abbaa\#aba$ - префикс подслова = суффикс слова $= a$; префикс-функция $= 1$\\
$abbaa\#abab$ - префикс подслова = суффикс слова $= ab$; префикс-функция $= 2$\\
$abbaa\#ababb$ - префикс подслова = суффикс слова $= abb$; префикс-функция $= 3$\\
$abbaa\#ababba$ - префикс подслова = суффикс слова $= abba$; префикс-функция $= 4$\\
$abbaa\#ababbab$ - префикс подслова = суффикс слова $= ab$; префикс-функция $= 2$\\
$abbaa\#ababbabb$ - префикс подслова = суффикс слова $= abb$; префикс-функция $= 3$\\
$abbaa\#ababbabba$ - префикс подслова = суффикс слова $= abba$; префикс-функция $= 4$\\
$abbaa\#ababbabbaa$ - префикс подслова = суффикс слова $= abbaa$; префикс-функция $= 5$\\
$abbaa\#ababbabbaab$ - префикс подслова = суффикс слова $= a$; префикс-функция $= 2$\\
\end{document}