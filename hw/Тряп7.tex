\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{tikz}
\usepackage{txfonts}
\usepackage[russian]{babel}

\title{Тряп-7}
\author{Волынцев Дмитрий 676 гр.}
\date{22 октября 2017}

\begin{document}

\maketitle

\section
\\
Пусть $L_1$ - нерегулярный, а значит в нем бесконечное множество слов (любой конечный язык - регулярный). Так как он нерегулярный, для него не выполняется лемма о накачке, т.е. для любого $p\geq1$ существует слово $xyz$ длины $>p$, где |$y$|$>0$ и |$xy$|$\leq p$, и $k\geq1$ такие, что слово $xy^kz$ не принадлежит $L_1$. Так как $R$ - конечный, можем выделить в нем самое длинное слово, пусть его длина $l$. Для $p\leq l+1$ возьмем слово длины $>l+1$. В соответствии с леммой о накачке для него не будет необходимого разбиения, а значит лемма не выполняется (слово не принадлежит $L$). Для $p>l+1$ для любого слова $xyz$ длины $>p$, где |$y$|$>0$ и |$xy$|$\leq p$, существует $k\geq1$ такое, что слово $xy^kz$ не принадлежит $L$ (его длина $>l$ для любого $k\geq0$, а значит оно не принадлежит $R$). Таким образом если слово не принадлежит $L_1$, значит оно не принадлежит $L$. То есть из нерегулярности языка $L_1$ следует нерегулярность языка $L$, что ложно, а значит $L_1$ не может быть нерегулярным.\\
\section
\\
В соответствии с алгоритмом сделаем автомат полным:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (15,-29.9) circle (3);
\draw (15,-29.9) node {$q_0$};
\draw [black] (43.6,-29.9) circle (3);
\draw (43.6,-29.9) node {$q_2$};
\draw [black] (28.9,-29.9) circle (3);
\draw (28.9,-29.9) node {$q_1$};
\draw [black] (28.9,-29.9) circle (2.4);
\draw [black] (58,-29.9) circle (3);
\draw (58,-29.9) node {$q_3$};
\draw [black] (58,-29.9) circle (2.4);
\draw [black] (28.9,-43.6) circle (3);
\draw (28.9,-43.6) node {$q_4$};
\draw [black] (6.6,-29.9) -- (12,-29.9);
\fill [black] (12,-29.9) -- (11.2,-29.4) -- (11.2,-30.4);
\draw [black] (31.179,-27.968) arc (121.44813:58.55187:9.719);
\fill [black] (41.32,-27.97) -- (40.9,-27.12) -- (40.38,-27.98);
\draw (36.25,-26.04) node [above] {$b$};
\draw [black] (41.328,-31.84) arc (-58.3804:-121.6196:9.685);
\fill [black] (31.17,-31.84) -- (31.59,-32.69) -- (32.12,-31.83);
\draw (36.25,-33.78) node [below] {$a$};
\draw [black] (46.6,-29.9) -- (55,-29.9);
\fill [black] (55,-29.9) -- (54.2,-29.4) -- (54.2,-30.4);
\draw (50.8,-29.4) node [above] {$b$};
\draw [black] (18,-29.9) -- (25.9,-29.9);
\fill [black] (25.9,-29.9) -- (25.1,-29.4) -- (25.1,-30.4);
\draw (21.95,-29.4) node [above] {$a$};
\draw [black] (16.872,-27.558) arc (138.11328:41.88672:26.366);
\fill [black] (56.13,-27.56) -- (55.97,-26.63) -- (55.22,-27.3);
\draw (36.5,-18.3) node [above] {$b$};
\draw [black] (28.9,-32.9) -- (28.9,-40.6);
\fill [black] (28.9,-40.6) -- (29.4,-39.8) -- (28.4,-39.8);
\draw (28.4,-36.75) node [left] {$a$};
\draw [black] (55.29,-31.18) -- (31.61,-42.32);
\fill [black] (31.61,-42.32) -- (32.55,-42.43) -- (32.13,-41.53);
\draw (45.12,-37.26) node [below] {$a,b$};
\draw [black] (30.223,-46.28) arc (54:-234:2.25);
\draw (28.9,-50.85) node [below] {$a,b$};
\fill [black] (27.58,-46.28) -- (26.7,-46.63) -- (27.51,-47.22);
\end{tikzpicture}
\end{center}
Теперь произведем склейку состояний в соответствии с алгоритмом. Разобьем множество состояний на множество принимающих и множество непринимающих:\\ $\{q_0,q_2,q_4$|$q_1,q_3\}$\\
Разобьем данные множества по переходам по $a$:\\
$\{q_0,q_2$|$q_4$|$q_1,q_3\}$\\
Разобьем данные множества по переходам по $b$:\\
$\{q_0,q_2$|$q_4$|$q_1$|$q_3\}$\\
Склеим состояния $q_0$ и $q_2$, оказавшиеся в одном множестве, в состояние $q_5$ и построим автомат:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (15,-29.9) circle (3);
\draw (15,-29.9) node {$q_5$};
\draw [black] (28.9,-29.9) circle (3);
\draw (28.9,-29.9) node {$q_1$};
\draw [black] (28.9,-29.9) circle (2.4);
\draw [black] (58,-29.9) circle (3);
\draw (58,-29.9) node {$q_3$};
\draw [black] (58,-29.9) circle (2.4);
\draw [black] (28.9,-43.6) circle (3);
\draw (28.9,-43.6) node {$q_4$};
\draw [black] (6.6,-29.9) -- (12,-29.9);
\fill [black] (12,-29.9) -- (11.2,-29.4) -- (11.2,-30.4);
\draw [black] (17.325,-28.025) arc (119.67725:60.32275:9.34);
\fill [black] (26.57,-28.03) -- (26.13,-27.19) -- (25.63,-28.06);
\draw (21.95,-26.3) node [above] {$a$};
\draw [black] (16.872,-27.558) arc (138.11328:41.88672:26.366);
\fill [black] (56.13,-27.56) -- (55.97,-26.63) -- (55.22,-27.3);
\draw (36.5,-18.3) node [above] {$b$};
\draw [black] (28.9,-32.9) -- (28.9,-40.6);
\fill [black] (28.9,-40.6) -- (29.4,-39.8) -- (28.4,-39.8);
\draw (28.4,-36.75) node [left] {$a$};
\draw [black] (55.29,-31.18) -- (31.61,-42.32);
\fill [black] (31.61,-42.32) -- (32.55,-42.43) -- (32.13,-41.53);
\draw (45.12,-37.26) node [below] {$a,b$};
\draw [black] (30.223,-46.28) arc (54:-234:2.25);
\draw (28.9,-50.85) node [below] {$a,b$};
\fill [black] (27.58,-46.28) -- (26.7,-46.63) -- (27.51,-47.22);
\draw [black] (26.451,-31.613) arc (-63.54314:-116.45686:10.102);
\fill [black] (17.45,-31.61) -- (17.94,-32.42) -- (18.39,-31.52);
\draw (21.95,-33.17) node [below] {$b$};
\end{tikzpicture}
\end{center}
Теперь удалим состояние $q_4$, так как из него невозможно попасть в принимающие состояния(можем и не удалять, тогда у нас будет минимальный полный автомат):\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (15,-29.9) circle (3);
\draw (15,-29.9) node {$q_5$};
\draw [black] (28.9,-29.9) circle (3);
\draw (28.9,-29.9) node {$q_1$};
\draw [black] (28.9,-29.9) circle (2.4);
\draw [black] (58,-29.9) circle (3);
\draw (58,-29.9) node {$q_3$};
\draw [black] (58,-29.9) circle (2.4);
\draw [black] (6.6,-29.9) -- (12,-29.9);
\fill [black] (12,-29.9) -- (11.2,-29.4) -- (11.2,-30.4);
\draw [black] (17.325,-28.025) arc (119.67725:60.32275:9.34);
\fill [black] (26.57,-28.03) -- (26.13,-27.19) -- (25.63,-28.06);
\draw (21.95,-26.3) node [above] {$a$};
\draw [black] (16.872,-27.558) arc (138.11328:41.88672:26.366);
\fill [black] (56.13,-27.56) -- (55.97,-26.63) -- (55.22,-27.3);
\draw (36.5,-18.3) node [above] {$b$};
\draw [black] (26.451,-31.613) arc (-63.54314:-116.45686:10.102);
\fill [black] (17.45,-31.61) -- (17.94,-32.42) -- (18.39,-31.52);
\draw (21.95,-33.17) node [below] {$b$};
\end{tikzpicture}
\end{center}
Таким образом мы минимизировали исходный автомат в соответствии с алгоритмом.\\
\section
\\
Используем построенный в прошлой задаче минимальный полный автомат и поменяем в нем терминальные состояния на нетерминальные и наоборот.\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (15,-29.9) circle (3);
\draw (15,-29.9) node {$q_0$};
\draw [black] (15,-29.9) circle (2.4);
\draw [black] (28.9,-29.9) circle (3);
\draw (28.9,-29.9) node {$q_1$};
\draw [black] (58,-29.9) circle (3);
\draw (58,-29.9) node {$q_3$};
\draw [black] (28.9,-43) circle (3);
\draw (28.9,-43) node {$q_2$};
\draw [black] (28.9,-43) circle (2.4);
\draw [black] (6.6,-29.9) -- (12,-29.9);
\fill [black] (12,-29.9) -- (11.2,-29.4) -- (11.2,-30.4);
\draw [black] (17.325,-28.025) arc (119.67725:60.32275:9.34);
\fill [black] (26.57,-28.03) -- (26.13,-27.19) -- (25.63,-28.06);
\draw (21.95,-26.3) node [above] {$a$};
\draw [black] (16.872,-27.558) arc (138.11328:41.88672:26.366);
\fill [black] (56.13,-27.56) -- (55.97,-26.63) -- (55.22,-27.3);
\draw (36.5,-18.3) node [above] {$b$};
\draw [black] (26.451,-31.613) arc (-63.54314:-116.45686:10.102);
\fill [black] (17.45,-31.61) -- (17.94,-32.42) -- (18.39,-31.52);
\draw (21.95,-33.17) node [below] {$b$};
\draw [black] (28.9,-32.9) -- (28.9,-40);
\fill [black] (28.9,-40) -- (29.4,-39.2) -- (28.4,-39.2);
\draw (28.4,-36.45) node [left] {$a$};
\draw [black] (55.26,-31.13) -- (31.64,-41.77);
\fill [black] (31.64,-41.77) -- (32.57,-41.9) -- (32.16,-40.98);
\draw (41.79,-35.93) node [above] {$a,b$};
\draw [black] (30.223,-45.68) arc (54:-234:2.25);
\draw (28.9,-50.25) node [below] {$a,b$};
\fill [black] (27.58,-45.68) -- (26.7,-46.03) -- (27.51,-46.62);
\end{tikzpicture}
\end{center}
Таким образом мы построили автомат для дополнения языка $L$. Теперь минимизируем его все по тому же алгоритму, разбивая множество состояний на подмножества:\\
Принимающие и непринимающие:\\
$\{q_0,q_2$|$q_1,q_3\}$\\
Разобьем данные множества по переходам по $a$:\\
$\{q_0$|$q_2$|$q_1,q_3\}$\\
Разобьем данные множества по переходам по $b$:\\
$\{q_0$|$q_2$|$q_1$|$q_3\}$\\
Таким образом, склеить ничего не удалось. Значит получившийся автомат и есть минимальный.\\
\section 
\\
Для любого слова $w$ слово $\Sigma^*ab\Sigma^*w$ также принадлежит языку. Таким образом $\Sigma^*ab\Sigma^*$ - класс эквивалентности(1).\\
Значит в других классах не будет подслов $ab$, то есть слова будут иметь вид $b^*a^*$. Если добавить к такому слову, содержащему $a$, слово, содержащее $b$, то новое слово будет принадлежать языку, а если не содержащее $b$, то нет. Значит все слова вида $b^*a^*a$ принадлежат одному классу эквивалентности(2).\\
Теперь рассмотрим оставшийся вид слов - $b^*$. Если добавить к такому слову слово, содержащее $ab$, то новое слово будет принадлежать языку, а если не содержащее $ab$, то нет. Таким образом слова вида $b^*$ принадлежат одному классу эквивалентности(3).\\
Все эти классы различны. Возьмем слово $\varepsilonup$ и добавим его поочередно ко всем 3 классам эквивалентности. Получим, что только в первом случае получится слово, принадлежащее языку, значит первый класс эквивалентности отличен от 2 и 3. Теперь возьмем слово $b$ и добавим его поочередно ко 2 и 3 классам эквивалентности. Получим, что только в первом случае получится слово, принадлежащее языку, значит 2 класс эквивалентности отличен от 3.\\
Теперь построим ДКА по алгоритму построения автомата, данного в доказательстве теоремы Майхилла-Нероуда, где $q_0$ соответствует классу $b^*$, $q_1$ - $b^*a^*a$, $q_2$ - $\Sigma^*ab\Sigma^*$:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (23.2,-29.9) circle (3);
\draw (23.2,-29.9) node {$q_0$};
\draw [black] (36.7,-29.9) circle (3);
\draw (36.7,-29.9) node {$q_1$};
\draw [black] (50.4,-29.9) circle (3);
\draw (50.4,-29.9) node {$q_2$};
\draw [black] (50.4,-29.9) circle (2.4);
\draw [black] (14.8,-29.9) -- (20.2,-29.9);
\fill [black] (20.2,-29.9) -- (19.4,-29.4) -- (19.4,-30.4);
\draw [black] (26.2,-29.9) -- (33.7,-29.9);
\fill [black] (33.7,-29.9) -- (32.9,-29.4) -- (32.9,-30.4);
\draw (29.95,-29.4) node [above] {$a$};
\draw [black] (39.7,-29.9) -- (47.4,-29.9);
\fill [black] (47.4,-29.9) -- (46.6,-29.4) -- (46.6,-30.4);
\draw (43.55,-29.4) node [above] {$b$};
\draw [black] (51.723,-32.58) arc (54:-234:2.25);
\draw (50.4,-37.15) node [below] {$a,b$};
\fill [black] (49.08,-32.58) -- (48.2,-32.93) -- (49.01,-33.52);
\draw [black] (38.023,-32.58) arc (54:-234:2.25);
\draw (36.7,-37.15) node [below] {$a$};
\fill [black] (35.38,-32.58) -- (34.5,-32.93) -- (35.31,-33.52);
\draw [black] (24.523,-32.58) arc (54:-234:2.25);
\draw (23.2,-37.15) node [below] {$b$};
\fill [black] (21.88,-32.58) -- (21,-32.93) -- (21.81,-33.52);
\end{tikzpicture}
\end{center}
\section
\\
1) Язык $L$ состоит из всех слов, в которых количество $a$ и $b$ одинаково. Пусть $\alpha = |w|_a - |w|_b$. Тогда классы эквивалентности будут различаться тем, что у принадлежащих им слов $\alpha$ будет различна, т.е. слова с одинаковой разностью количсетва $a$ и $b$ будут принадлежать одному классу эквивалентности. В этом легко убедиться, добавив к таким словам любое слово с разностью $-\alpha$ и получая слово, принадлежащее $L$. Если же добавить любое другое слово, новое слово не будет принадлежать $L$. В силу неограниченности выбора количества $a$ и $b$ таких классов будет бесконечно много. Различны они потому, что для каждой $\alpha$ нужны разные слова, добаивив которые к исходным, мы получим слово из $L$.\\
\\
2) Разделим слова на следующие классы:\\
$\varepsilonup$ - класс эквивалентности($xz = yz$, для $x$ и $y$ всегда одинаковый результат)(1)\\
$a\Sigma^*a \cup a$  - класс эквивалентности(2)\\
$b\Sigma^*b \cup b$  - класс эквивалентности(3)\\
$a\Sigma^*b$  - класс эквивалентности(4)\\
$b\Sigma^*a$  - класс эквивалентности(5)\\
Все они различны, так как при добавлении одного слвоа из $\varepsilonup,a,b$ для одного класса слово будет принадлежатьязыку, а для другого нет. Например для (1 и 2) и (2 и 3) классов это слово $b$, для 1 и 4 - слово $a$ и т.д. Таким образом, все эти классы эквивалентности попарно различны.\\
Теперь построим соответствующий минимальный полный ДКА:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (32.9,-29.7) circle (3);
\draw (32.9,-29.7) node {$q_0$};
\draw [black] (32.9,-29.7) circle (2.4);
\draw [black] (32.9,-43.4) circle (3);
\draw (32.9,-43.4) node {$q_3$};
\draw [black] (32.9,-43.4) circle (2.4);
\draw [black] (49.3,-43.4) circle (3);
\draw (49.3,-43.4) node {$q_4$};
\draw [black] (49.3,-43.4) circle (2.4);
\draw [black] (32.9,-17.2) circle (3);
\draw (32.9,-17.2) node {$q_1$};
\draw [black] (32.9,-17.2) circle (2.4);
\draw [black] (49.3,-17.2) circle (3);
\draw (49.3,-17.2) node {$q_2$};
\draw [black] (24.5,-29.7) -- (29.9,-29.7);
\fill [black] (29.9,-29.7) -- (29.1,-29.2) -- (29.1,-30.2);
\draw [black] (32.9,-32.7) -- (32.9,-40.4);
\fill [black] (32.9,-40.4) -- (33.4,-39.6) -- (32.4,-39.6);
\draw (33.4,-36.55) node [right] {$b$};
\draw [black] (35.395,-41.747) arc (116.75074:63.24926:12.675);
\fill [black] (46.81,-41.75) -- (46.32,-40.94) -- (45.87,-41.83);
\draw (41.1,-39.89) node [above] {$a$};
\draw [black] (32.9,-26.7) -- (32.9,-20.2);
\fill [black] (32.9,-20.2) -- (32.4,-21) -- (33.4,-21);
\draw (33.4,-23.45) node [right] {$a$};
\draw [black] (46.802,-18.849) arc (-63.33338:-116.66662:12.705);
\fill [black] (46.8,-18.85) -- (45.86,-18.76) -- (46.31,-19.65);
\draw (41.1,-20.7) node [below] {$b$};
\draw [black] (35.458,-15.645) arc (114.88906:65.11094:13.406);
\fill [black] (35.46,-15.64) -- (36.39,-15.76) -- (35.97,-14.85);
\draw (41.1,-13.9) node [above] {$a$};
\draw [black] (46.742,-44.956) arc (-65.10099:-114.89901:13.401);
\fill [black] (35.46,-44.96) -- (35.97,-45.75) -- (36.39,-44.84);
\draw (41.1,-46.7) node [below] {$b$};
\draw [black] (30.22,-18.523) arc (324:36:2.25);
\draw (25.65,-17.2) node [left] {$a$};
\fill [black] (30.22,-15.88) -- (29.87,-15) -- (29.28,-15.81);
\draw [black] (51.98,-15.877) arc (144:-144:2.25);
\draw (56.55,-17.2) node [right] {$b$};
\fill [black] (51.98,-18.52) -- (52.33,-19.4) -- (52.92,-18.59);
\draw [black] (30.22,-44.723) arc (324:36:2.25);
\draw (25.65,-43.4) node [left] {$b$};
\fill [black] (30.22,-42.08) -- (29.87,-41.2) -- (29.28,-42.01);
\draw [black] (51.98,-42.077) arc (144:-144:2.25);
\draw (56.55,-43.4) node [right] {$a$};
\fill [black] (51.98,-44.72) -- (52.33,-45.6) -- (52.92,-44.79);
\end{tikzpicture}
\end{center}
\end{document}
