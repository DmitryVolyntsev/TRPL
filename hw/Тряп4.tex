\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{tikz}
\usepackage{txfonts}
\usepackage[russian]{babel}

\title{Тряп-4}
\author{Волынцев Дмитрий 676 гр.}
\date{2 октября 2017}

\begin{document}

\maketitle

\section
\\
Искомый словарь:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (19.3,-30) circle (3);
\draw (19.3,-30) node {$\varepsilonup$};
\draw [black] (33.3,-16.4) circle (3);
\draw (33.3,-16.4) node {$a$};
\draw [black] (33.3,-30) circle (3);
\draw (33.3,-30) node {$c$};
\draw [black] (33.3,-42.5) circle (3);
\draw (33.3,-42.5) node {$b$};
\draw [black] (46.6,-16.4) circle (3);
\draw (46.6,-16.4) node {$aa$};
\draw [black] (46.6,-16.4) circle (2.4);
\draw [black] (46.6,-4.5) circle (3);
\draw (46.6,-4.5) node {$ab$};
\draw [black] (46.6,-4.5) circle (2.4);
\draw [black] (60.7,-4.5) circle (3);
\draw (60.7,-4.5) node {$abc$};
\draw [black] (60.7,-4.5) circle (2.4);
\draw [black] (46.6,-42.5) circle (3);
\draw (46.6,-42.5) node {$bc$};
\draw [black] (46.6,-42.5) circle (2.4);
\draw [black] (46.6,-53.9) circle (3);
\draw (46.6,-53.9) node {$bb$};
\draw [black] (60.7,-53.9) circle (3);
\draw (60.7,-53.9) node {$bbc$};
\draw [black] (60.7,-53.9) circle (2.4);
\draw [black] (46.6,-30) circle (3);
\draw (46.6,-30) node {$cb$};
\draw [black] (46.6,-30) circle (2.4);
\draw [black] (21.45,-27.91) -- (31.15,-18.49);
\fill [black] (31.15,-18.49) -- (30.23,-18.69) -- (30.92,-19.41);
\draw (27.26,-23.68) node [below] {$a$};
\draw [black] (21.54,-32) -- (31.06,-40.5);
\fill [black] (31.06,-40.5) -- (30.8,-39.6) -- (30.13,-40.34);
\draw (25.29,-36.74) node [below] {$b$};
\draw [black] (9.6,-30) -- (16.3,-30);
\fill [black] (16.3,-30) -- (15.5,-29.5) -- (15.5,-30.5);
\draw [black] (36.3,-16.4) -- (43.6,-16.4);
\fill [black] (43.6,-16.4) -- (42.8,-15.9) -- (42.8,-16.9);
\draw (39.95,-16.9) node [below] {$a$};
\draw [black] (35.54,-14.4) -- (44.36,-6.5);
\fill [black] (44.36,-6.5) -- (43.43,-6.66) -- (44.1,-7.41);
\draw (40.96,-10.94) node [below] {$b$};
\draw [black] (49.6,-4.5) -- (57.7,-4.5);
\fill [black] (57.7,-4.5) -- (56.9,-4) -- (56.9,-5);
\draw (53.65,-5) node [below] {$c$};
\draw [black] (36.3,-42.5) -- (43.6,-42.5);
\fill [black] (43.6,-42.5) -- (42.8,-42) -- (42.8,-43);
\draw (39.95,-43) node [below] {$c$};
\draw [black] (35.58,-44.45) -- (44.32,-51.95);
\fill [black] (44.32,-51.95) -- (44.04,-51.05) -- (43.39,-51.81);
\draw (38.94,-48.69) node [below] {$b$};
\draw [black] (49.6,-53.9) -- (57.7,-53.9);
\fill [black] (57.7,-53.9) -- (56.9,-53.4) -- (56.9,-54.4);
\draw (53.65,-54.4) node [below] {$c$};
\draw [black] (36.3,-30) -- (43.6,-30);
\fill [black] (43.6,-30) -- (42.8,-29.5) -- (42.8,-30.5);
\draw (39.95,-30.5) node [below] {$b$};
\draw [black] (22.3,-30) -- (30.3,-30);
\fill [black] (30.3,-30) -- (29.5,-29.5) -- (29.5,-30.5);
\draw (26.3,-30.5) node [below] {$c$};
\end{tikzpicture}
\end{center}
\\
Согласно алгоритму построим на его основе автомат Ахо-Корасик:\\
Добавим суффиксные ссылки по алгоритму:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (19.3,-30) circle (3);
\draw (19.3,-30) node {$\varepsilonup$};
\draw [black] (33.3,-16.4) circle (3);
\draw (33.3,-16.4) node {$a$};
\draw [black] (19.3,-54.3) circle (3);
\draw (19.3,-54.3) node {$c$};
\draw [black] (40.8,-30) circle (3);
\draw (40.8,-30) node {$b$};
\draw [black] (33.3,-4.5) circle (3);
\draw (33.3,-4.5) node {$aa$};
\draw [black] (33.3,-4.5) circle (2.4);
\draw [black] (46.6,-4.5) circle (3);
\draw (46.6,-4.5) node {$ab$};
\draw [black] (46.6,-4.5) circle (2.4);
\draw [black] (60.7,-4.5) circle (3);
\draw (60.7,-4.5) node {$abc$};
\draw [black] (60.7,-4.5) circle (2.4);
\draw [black] (69.9,-30) circle (3);
\draw (69.9,-30) node {$bc$};
\draw [black] (69.9,-30) circle (2.4);
\draw [black] (46.6,-18.1) circle (3);
\draw (46.6,-18.1) node {$bb$};
\draw [black] (61.6,-18.1) circle (3);
\draw (61.6,-18.1) node {$bbc$};
\draw [black] (61.6,-18.1) circle (2.4);
\draw [black] (40.8,-54.3) circle (3);
\draw (40.8,-54.3) node {$cb$};
\draw [black] (40.8,-54.3) circle (2.4);
\draw [black] (21.45,-27.91) -- (31.15,-18.49);
\fill [black] (31.15,-18.49) -- (30.23,-18.69) -- (30.92,-19.41);
\draw (25.34,-22.72) node [above] {$a$};
\draw [black] (22.3,-30) -- (37.8,-30);
\fill [black] (37.8,-30) -- (37,-29.5) -- (37,-30.5);
\draw (30.05,-29.5) node [above] {$b$};
\draw [black] (9.6,-30) -- (16.3,-30);
\fill [black] (16.3,-30) -- (15.5,-29.5) -- (15.5,-30.5);
\draw [black] (33.3,-13.4) -- (33.3,-7.5);
\fill [black] (33.3,-7.5) -- (32.8,-8.3) -- (33.8,-8.3);
\draw (32.8,-10.45) node [left] {$a$};
\draw [black] (35.54,-14.4) -- (44.36,-6.5);
\fill [black] (44.36,-6.5) -- (43.43,-6.66) -- (44.1,-7.41);
\draw (38.94,-9.96) node [above] {$b$};
\draw [black] (49.6,-4.5) -- (57.7,-4.5);
\fill [black] (57.7,-4.5) -- (56.9,-4) -- (56.9,-5);
\draw (53.65,-4) node [above] {$c$};
\draw [black] (43.8,-30) -- (66.9,-30);
\fill [black] (66.9,-30) -- (66.1,-29.5) -- (66.1,-30.5);
\draw (55.35,-30.5) node [below] {$c$};
\draw [black] (42.11,-27.3) -- (45.29,-20.8);
\fill [black] (45.29,-20.8) -- (44.49,-21.3) -- (45.38,-21.73);
\draw (44.4,-25.13) node [right] {$b$};
\draw [black] (49.6,-18.1) -- (58.6,-18.1);
\fill [black] (58.6,-18.1) -- (57.8,-17.6) -- (57.8,-18.6);
\draw (54.1,-18.6) node [below] {$c$};
\draw [black] (22.3,-54.3) -- (37.8,-54.3);
\fill [black] (37.8,-54.3) -- (37,-53.8) -- (37,-54.8);
\draw (30.05,-54.8) node [below] {$b$};
\draw [black] (19.3,-33) -- (19.3,-51.3);
\fill [black] (19.3,-51.3) -- (19.8,-50.5) -- (18.8,-50.5);
\draw (18.8,-42.15) node [left] {$c$};
\draw [dotted][black] (18.917,-27.034) arc (-180.33286:-271.32777:11.171);
\fill [black] (18.92,-27.03) -- (19.42,-26.24) -- (18.42,-26.23);
\draw (21.16,-18.61) node [above] {$c$};
\draw [dotted][black] (30.731,-14.908) arc (-134.01367:-225.98633:6.199);
\fill [black] (30.73,-14.91) -- (30.5,-13.99) -- (29.81,-14.71);
\draw (28.34,-10.45) node [left] {$b,c$};
\draw [dotted][black] (40.55,-27.011) arc (-177.44989:-208.17806:38.561);
\fill [black] (40.55,-27.01) -- (41.01,-26.19) -- (40.02,-26.23);
\draw (40.72,-16.35) node [left] {$a,b$};
\draw [dotted][black] (63.249,-6.076) arc (53.96816:-14.29086:19.974);
\fill [black] (70.86,-27.16) -- (71.54,-26.51) -- (70.57,-26.26);
\draw (71.05,-14.67) node [right] {$a,b,c$};
\draw [dotted][black] (20.269,-32.838) arc (16.27092:-16.27092:33.236);
\fill [black] (20.27,-32.84) -- (20.01,-33.75) -- (20.97,-33.47);
\draw (22.1,-42.15) node [right] {$a,c$};
\draw [dotted][black] (39.31,-51.699) arc (-154.11954:-205.88046:21.876);
\fill [black] (39.31,-32.6) -- (38.51,-33.1) -- (39.41,-33.54);
\draw (36.62,-42.15) node [left] {$a,b,c$};
\draw [dotted][black] (21.737,-28.258) arc (120.33569:59.66431:16.459);
\fill [black] (21.74,-28.26) -- (22.68,-28.29) -- (22.18,-27.42);
\draw (30.05,-25.5) node [above] {$a$};
\draw [dotted][black] (69.311,-32.941) arc (-13.85939:-114.83651:34.04);
\fill [black] (21.96,-55.68) -- (22.48,-56.47) -- (22.9,-55.56);
\draw (53.89,-55.99) node [below] {$a,b,c$};
\draw [dotted][black] (47.73,-20.859) arc (11.09604:-63.06478:7.687);
\fill [black] (43.67,-29.19) -- (44.61,-29.27) -- (44.16,-28.38);
\draw (47.8,-26.79) node [right] {$a,b$};
\draw [dotted][black] (63.935,-19.979) arc (47.04959:22.74034:20.789);
\fill [black] (68.94,-27.16) -- (69.1,-26.23) -- (68.17,-26.61);
\draw (67.42,-21.94) node [right] {$a,b,c$};
\end{tikzpicture}
\end{center}
\\
Теперь заменим суффиксные ссылки явными переходами согласно алгоритму:\\
\begin{center}
\begin{tikzpicture}[scale=0.2]
\tikzstyle{every node}+=[inner sep=0pt]
\draw [black] (14.5,-54.2) circle (3);
\draw (14.5,-54.2) node {$\varepsilonup$};
\draw [black] (15.7,-45.8) circle (3);
\draw (15.7,-45.8) node {$a$};
\draw [black] (14.5,-6.4) circle (3);
\draw (14.5,-6.4) node {$c$};
\draw [black] (30.4,-55.8) circle (3);
\draw (30.4,-55.8) node {$b$};
\draw [black] (19.1,-24.7) circle (3);
\draw (19.1,-24.7) node {$aa$};
\draw [black] (19.1,-24.7) circle (2.4);
\draw [black] (29,-28.3) circle (3);
\draw (29,-28.3) node {$ab$};
\draw [black] (29,-28.3) circle (2.4);
\draw [black] (39.8,-26.2) circle (3);
\draw (39.8,-26.2) node {$abc$};
\draw [black] (39.8,-26.2) circle (2.4);
\draw [black] (74.1,-10) circle (3);
\draw (74.1,-10) node {$bc$};
\draw [black] (74.1,-10) circle (2.4);
\draw [black] (37.9,-48) circle (3);
\draw (37.9,-48) node {$bb$};
\draw [black] (54.7,-44) circle (3);
\draw (54.7,-44) node {$bbc$};
\draw [black] (54.7,-44) circle (2.4);
\draw [black] (64.4,-29.3) circle (3);
\draw (64.4,-29.3) node {$cb$};
\draw [black] (64.4,-29.3) circle (2.4);
\draw [black] (14.92,-51.23) -- (15.28,-48.77);
\fill [black] (15.28,-48.77) -- (14.67,-49.49) -- (15.66,-49.63);
\draw (14.41,-49.83) node [left] {$a$};
\draw [black] (17.48,-54.5) -- (27.42,-55.5);
\fill [black] (27.42,-55.5) -- (26.67,-54.92) -- (26.57,-55.92);
\draw (22.64,-54.42) node [above] {$b$};
\draw [black] (4.8,-54.2) -- (11.5,-54.2);
\fill [black] (11.5,-54.2) -- (10.7,-53.7) -- (10.7,-54.7);
\draw [black] (15.818,-42.803) arc (176.61857:165.07381:76.638);
\fill [black] (18.27,-27.58) -- (17.58,-28.23) -- (18.55,-28.48);
\draw (15.95,-34.92) node [left] {$a$};
\draw [black] (16.375,-42.879) arc (163.3366:122.19373:23.497);
\fill [black] (26.37,-29.73) -- (25.42,-29.74) -- (25.96,-30.58);
\draw (19.6,-34) node [left] {$b$};
\draw [black] (31.94,-27.73) -- (36.86,-26.77);
\fill [black] (36.86,-26.77) -- (35.97,-26.43) -- (36.17,-27.42);
\draw (33.89,-26.67) node [above] {$c$};
\draw [black] (74.992,-12.864) arc (14.86691:-102.17867:35.405);
\fill [black] (74.99,-12.86) -- (74.71,-13.77) -- (75.68,-13.51);
\draw (66.92,-47.86) node [right] {$c$};
\draw [black] (32.48,-53.64) -- (35.82,-50.16);
\fill [black] (35.82,-50.16) -- (34.91,-50.39) -- (35.63,-51.09);
\draw (34.68,-53.37) node [right] {$b$};
\draw [black] (40.82,-47.31) -- (51.78,-44.69);
\fill [black] (51.78,-44.69) -- (50.89,-44.39) -- (51.12,-45.37);
\draw (46.95,-46.57) node [below] {$c$};
\draw [black] (17.23,-7.65) -- (61.67,-28.05);
\fill [black] (61.67,-28.05) -- (61.15,-27.26) -- (60.74,-28.17);
\draw (38.47,-18.36) node [below] {$b$};
\draw [black] (12.707,-51.796) arc (-145.5384:-214.4616:37.989);
\fill [black] (12.71,-8.8) -- (11.84,-9.18) -- (12.67,-9.75);
\draw (5.54,-30.3) node [left] {$c$};
\draw [black] (71.11,-9.82) -- (17.49,-6.58);
\fill [black] (17.49,-6.58) -- (18.26,-7.13) -- (18.32,-6.13);
\draw (44.37,-7.65) node [above] {$c$};
\draw [black] (14.065,-43.286) arc (-149.38405:-207.12693:35.511);
\fill [black] (13.02,-9.01) -- (12.21,-9.49) -- (13.1,-9.95);
\draw (8.59,-26.29) node [left] {$c$};
\draw [black] (11.592,-7.086) arc (311.00538:23.00538:2.25);
\draw (7.17,-4.48) node [left] {$c$};
\fill [black] (12.19,-4.51) -- (12.04,-3.58) -- (11.28,-4.23);
\draw [black] (14.999,-42.883) arc (-167.44383:-189.06715:89.414);
\fill [black] (15,-42.88) -- (15.31,-41.99) -- (14.34,-42.21);
\draw (12.36,-26.18) node [left] {$a$};
\draw [black] (21.92,-25.73) -- (26.18,-27.27);
\fill [black] (26.18,-27.27) -- (25.6,-26.53) -- (25.26,-27.47);
\draw (24.98,-25.97) node [above] {$b$};
\draw [black] (18.37,-21.79) -- (15.23,-9.31);
\fill [black] (15.23,-9.31) -- (14.94,-10.21) -- (15.91,-9.96);
\draw (17.56,-15.09) node [right] {$c$};
\draw [black] (27.92,-54.11) -- (18.18,-47.49);
\fill [black] (18.18,-47.49) -- (18.56,-48.35) -- (19.12,-47.52);
\draw (24,-50.3) node [above] {$a$};
\draw [black] (34.91,-47.7) -- (18.69,-46.1);
\fill [black] (18.69,-46.1) -- (19.43,-46.67) -- (19.53,-45.68);
\draw (26.98,-46.32) node [above] {$a$};
\draw [black] (38.231,-45.03) arc (201.37468:-86.62532:2.25);
\draw (42.54,-41.82) node [above] {$b$};
\fill [black] (40.46,-46.46) -- (41.39,-46.63) -- (41.02,-45.7);
\draw [black] (27.18,-30.69) -- (17.52,-43.41);
\fill [black] (17.52,-43.41) -- (18.4,-43.08) -- (17.6,-42.47);
\draw (21.78,-35.65) node [left] {$a$};
\draw [black] (35.737,-45.923) arc (-137.23107:-174.14425:25.351);
\fill [black] (35.74,-45.92) -- (35.56,-45) -- (34.83,-45.68);
\draw (30.52,-40.15) node [left] {$b$};
\draw [black] (61.56,-30.26) -- (18.54,-44.84);
\fill [black] (18.54,-44.84) -- (19.46,-45.05) -- (19.14,-44.11);
\draw (39.2,-37.02) node [above] {$a$};
\draw [black] (64.82,-32.267) arc (3.16073:-112.74253:17.52);
\fill [black] (40.55,-49.39) -- (41.1,-50.16) -- (41.49,-49.24);
\draw (58.43,-48.05) node [below] {$b$};
\draw [black] (74.33,-12.988) arc (-0.24722:-53.12013:18.494);
\fill [black] (74.33,-12.99) -- (73.83,-13.79) -- (74.83,-13.79);
\draw (73.06,-22.32) node [right] {$c$};
\draw [black] (71.54,-11.57) -- (18.26,-44.23);
\fill [black] (18.26,-44.23) -- (19.2,-44.24) -- (18.68,-43.39);
\draw (45.84,-28.4) node [below] {$a$};
\draw [black] (72.75,-12.68) -- (65.75,-26.62);
\fill [black] (65.75,-26.62) -- (66.55,-26.13) -- (65.66,-25.68);
\draw (68.55,-18.54) node [left] {$b$};
\draw [black] (56.35,-41.5) -- (62.75,-31.8);
\fill [black] (62.75,-31.8) -- (61.89,-32.2) -- (62.72,-32.75);
\draw (60.16,-37.98) node [right] {$b$};
\draw [black] (17.453,-5.875) arc (97.50014:-3.67203:33.296);
\fill [black] (17.45,-5.88) -- (18.31,-6.27) -- (18.18,-5.27);
\draw (45.5,-14.08) node [above] {$c$};
\draw [black] (37.47,-28.09) -- (18.03,-43.91);
\fill [black] (18.03,-43.91) -- (18.96,-43.79) -- (18.33,-43.01);
\draw (26.8,-35.51) node [above] {$a$};
\draw [black] (41.281,-23.599) arc (143.68104:21.95428:12.884);
\fill [black] (63.61,-26.41) -- (63.78,-25.48) -- (62.85,-25.86);
\draw (53.55,-17.86) node [above] {$b$};
\draw [black] (37.44,-24.35) -- (16.86,-8.25);
\fill [black] (16.86,-8.25) -- (17.18,-9.14) -- (17.8,-8.35);
\draw (28.1,-15.8) node [above] {$c$};
\end{tikzpicture}
\end{center}
\\
Теперь посчитаем с его помощью количество вхождений слов из словаря $S$ в подслово $abbbccabcbca$. Будем посимвольно считывать слово и посимвольно переходить по состояниям. Если мы оказались в принимающем состоянии, значит у нас вхождение слова из словаря. Таким образом ведем подсчет этих вхождений (в скобках).\\
Протокол работы алгоритма:\\
$(\varepsilonup,abbbccabcbca) \vdash (a,bbbccabcbca) \vdash (ab,bbccabcbca)(1) \vdash (bb,bccabcbca) \vdash (bb,ccabcbca) \vdash (bbc,cabcbca)(2) \vdash (c,abcbca) \vdash (a,bcbca) \vdash (ab,cbca)(3) \vdash (abc,bca)(4) \vdash (cb,ca)(5) \vdash (bc,a)(6) \vdash (a,\varepsilonup)$
Таким образом мы получили 6 вхождений(использовали автомат с переходами, а не со ссылками, поэтому не учитывали слова, являющиеся подсловами других слов).\\
\section
\\

\section
\\

\section 
\\
1) $L = \{a^{2^n}\mid n>0\}$\\
Пусть $L$ - регулярный. Тогда язык $L' = L \cap ab^*$ - также регулярный, а значит удовлетворяет лемме о накачке. Докажем обратное.\\
Для любой $C$ существует слово $\omega = ab^{2^C}$, принадлежащее языку $L'$, причем $|\omega|\geq C$. Пусть $\omega = xyz$. Возможны несколько случаев:\\
а) $x = \varepsilonup$. Тогда либо $y = a$, либо $y = ab^s$ ($s>0$). В первом случае слово $xy^qz$ при $q\geq2$ будет содеражть более одного $a$, а значит не принадлежать $L'$. Во втором случае в слове $xyyz$ $a$ будет стоять после $b$ - опять не принадлежит $L'$.\\
б) $x = ab^s$, $s\geq0$. Тогда $y = b^t$, $z = b^{2^C-t-s}$. Если все слова вида $xy^qz$ принадлежат $L'$, то в каждом слове количество $b$ - степень двойки. При этом количествА $b$ образуют арифметическую прогрессию с разностью $t>0$ - противоречие.\\ Таким образом, $L'$ - нерегулярный, значит $L$ - нерегулярный.\\
\\
2)\\
\\
3) $L = \{w \mid |w|_a = |w|_b\}$\\
Применим отрицание леммы о накачке:\\
$\forall q$ выберем $w = a^{2q}b^{2q}$, $|w|>q$. Тогда для любого разбиения $w = xyz$ $xy = a^k$, $k\leq q$, значит $y = a^l$, $l\leq k$. Тогда $\forall i>1$ количество $b$ не изменится, а количество $a$ увеличится, а значит слово $w$ не принадлежит $L$.\\
Таким образом, $L$ - нерегулярный.\\
\\
4)\\
\end{document}